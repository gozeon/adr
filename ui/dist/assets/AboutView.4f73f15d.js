import{d as O,u as q,c as _,a as z,r as E,b as p,e,t as m,f as o,F as y,g as D,h as j,w as C,_ as S,i as I,j as Q,o as c,k as g,n as R,l as h,v as b,m as A,p as L,q as G}from"./index.2af80367.js";import{u as H,Q as J,I as K}from"./record.004b23f5.js";const W={class:"list-decimal mt-12 px-20"},X={class:"mb-3 hover:bg-stone-100 pl-4 cursor-pointer"},Y=["onClick"],Z=["onClick"],tt=["value","onChange"],et=["value"],st=e("div",{class:"py-20"},null,-1),ot=["onSubmit"],at={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},lt=e("label",{class:"col-span-1 self-center md:justify-self-center"},"Title",-1),nt={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},rt=e("label",{class:"col-span-1 self-start md:justify-self-center"},"Description",-1),it={class:"col-span-3 h-[50vh]"},ct=e("div",{class:"grid grid-cols-4 col-span-2 mt-20 <sm:mt-30"},[e("button",{type:"submit",class:"col-start-2 <sm:col-start-1 py-2 bg-light-100 rounded-sm border-1 border-dark-300 hover:bg-dark-400 hover:text-white focus:ring-2 focus:ring-gray-300"},"Save")],-1),dt=["onSubmit"],pt={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},ut=e("label",{class:"col-span-1 self-center"},"ID",-1),mt={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},gt=e("label",{class:"col-span-1 self-center"},"Name",-1),ht={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},bt=e("label",{class:"col-span-1 self-center"},"Description",-1),ft=e("div",{class:"grid grid-cols-4 col-span-2"},[e("button",{type:"submit",class:"col-start-2 <sm:col-start-1 py-2 bg-light-100 rounded-sm border-1 border-dark-300 hover:bg-dark-400 hover:text-white focus:ring-2 focus:ring-gray-300"},"Save")],-1),xt=O({__name:"AboutView",setup(_t){const U=Q(),M=L(),u=q(),r=H(),l=_(()=>u.activeProject),N=_(()=>r.activeRecords),V=_(()=>r.statusMap),i=U.params.id,{openModal:f,hasRole:v,closeModal:x}=z(),B=G("axios"),P={name:"blotFormatter",module:K,options:{upload:a=>{const s=new FormData;return s.append("file",a),B.post("/api/upload",s,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data.data.fullpath)}}};u.loadDetail(i),r.loadRecordByID(i);const $=async(a,s)=>{await r.updateStatus(s,+a.target.value),r.loadRecordByID(i)},k={title:"",description:"",status:1},n=E({...k}),F=async()=>{console.log(n);const{data:a}=await r.createOrUpdateRecord({...n,project_id:+i});(a==null?void 0:a.errNo)==0?(Object.assign(n,{...k}),r.loadRecordByID(i),x("create")):alert(a.errMsg)},w=async a=>{M.push({name:"record",params:{id:a,pid:i}})},T=async()=>{var s,t;const a=await u.createOrUpdateProject({...l.value});((s=a.data)==null?void 0:s.errNo)===0?(u.loadDetail(i),x("update"),Object.assign(n,{})):alert((t=a.data)==null?void 0:t.errMsg)};return(a,s)=>(c(),p(y,null,[e("h3",{class:"mt-10 text-3xl cursor-pointer divide-light-600 px-3 md:px-4",onClick:s[0]||(s[0]=t=>o(f)("update"))},m(o(l).title),1),e("p",{class:"mt-4 px-3 md:px-4 cursor-pointer",onClick:s[1]||(s[1]=t=>o(f)("update"))},m(o(l).description),1),e("ul",W,[(c(!0),p(y,null,D(o(N),t=>(c(),p("li",X,[e("div",{class:"flex justify-between <sm:flex-col <sm:gap-2",onClick:g(d=>w(t.ID),["self"])},[e("div",{class:R(["underline",{"text-notion-yellow":t.status==1,"text-notion-teal":t.status==2,"":t.status==3,"text-notion-red line-through":t.status==4,"text-notion-gray line-through":t.status==5}]),onClick:g(d=>w(t.ID),["self"])},m(t.title),11,Z),e("select",{class:R(["px-10",{"bg-notion-yellow_background":t.status==1,"bg-notion-teal_background":t.status==2,"":t.status==3,"bg-notion-red_background":t.status==4,"bg-notion-gray_background":t.status==5}]),value:t.status,onChange:d=>$(d,t.ID)},[(c(!0),p(y,null,D(o(V),d=>(c(),p("option",{value:d.val},m(d.label),9,et))),256))],42,tt)],8,Y)]))),256))]),e("div",{class:"decoration-gray-400 px-4 text-center border-1 border-dark-500 border-dashed cursor-pointer hover:bg-stone-100 mx-20 mt-5 text-center w-2/4 xl:w-1/3 <sm:w-9/12 <sm:mt-10 <sm:mx-auto",onClick:s[2]||(s[2]=t=>o(f)("create"))}," + "),st,o(v)("create")?(c(),j(S,{key:0,type:"create"},{default:C(()=>[e("form",{onSubmit:g(F,["prevent"]),class:"bg-white w-3/4 xl:w-2/3 <sm:w-11/12 m-auto px-8 py-5 mt-3 opacity-100 break-all"},[e("div",at,[lt,h(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>n.title=t),required:"",minlength:"3",maxlength:"50",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Record Title"},null,512),[[b,n.title]])]),e("div",nt,[rt,e("div",it,[A(o(J),{placeholder:"Record Description",modules:P,"content-type":"html",content:n.description,"onUpdate:content":s[4]||(s[4]=t=>n.description=t)},null,8,["content"])])]),ct],40,ot)]),_:1})):I("",!0),o(v)("update")?(c(),j(S,{key:1,type:"update"},{default:C(()=>[e("form",{onSubmit:g(T,["prevent"]),class:"bg-white w-3/4 xl:w-1/3 <sm:w-11/12 m-auto px-8 py-5 mt-3 opacity-100"},[e("div",pt,[ut,h(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>o(l).ID=t),type:"text",readonly:"",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500",placeholder:"Project Name"},null,512),[[b,o(l).ID]])]),e("div",mt,[gt,h(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>o(l).title=t),type:"text",required:"",minlength:"3",maxlength:"50",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Project Name"},null,512),[[b,o(l).title]])]),e("div",ht,[bt,h(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=t=>o(l).description=t),maxlength:"120",class:"col-span-3 resize-none p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Project Description"},null,512),[[b,o(l).description]])]),ft],40,dt)]),_:1})):I("",!0)],64))}});export{xt as default};
