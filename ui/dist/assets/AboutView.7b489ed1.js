import{d as O,u as T,c as _,a as F,r as q,b as u,e,t as g,f as o,F as y,g as w,h as D,w as j,_ as S,i as C,j as z,o as c,k as f,n as R,l as m,v as h,m as E,p as Q}from"./index.3c6f1c6f.js";import{u as A,Q as L}from"./record.50dea252.js";const G={class:"list-decimal mt-12 px-20"},H={class:"mb-3 hover:bg-stone-100 px-4 cursor-pointer"},J=["onClick"],K=["value","onChange"],W=["value"],X=e("div",{class:"py-20"},null,-1),Y=["onSubmit"],Z={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},tt=e("label",{class:"col-span-1 self-center md:justify-self-center"},"Title",-1),et={class:"grid grid-cols-4 <sm:grid-cols-1 col-span-2 mb-5"},st=e("label",{class:"col-span-1 self-start md:justify-self-center"},"Description",-1),ot={class:"col-span-3 h-[50vh]"},at=e("div",{class:"grid grid-cols-4 col-span-2 mt-20"},[e("button",{type:"submit",class:"col-start-2 <sm:col-start-1 py-2 bg-light-100 rounded-sm border-1 border-dark-300 hover:bg-dark-400 hover:text-white focus:ring-2 focus:ring-gray-300"},"Save")],-1),lt=["onSubmit"],nt={class:"grid grid-cols-4 col-span-2 mb-5"},rt=e("label",{class:"col-span-1 self-center"},"ID",-1),it={class:"grid grid-cols-4 col-span-2 mb-5"},ct=e("label",{class:"col-span-1 self-center"},"Name",-1),dt={class:"grid grid-cols-4 col-span-2 mb-5"},ut=e("label",{class:"col-span-1 self-center"},"Description",-1),pt=e("div",{class:"grid grid-cols-4 col-span-2"},[e("button",{type:"submit",class:"col-start-2 py-2 bg-light-100 rounded-sm border-1 border-dark-300 hover:bg-dark-400 hover:text-white focus:ring-2 focus:ring-gray-300"},"Save")],-1),bt=O({__name:"AboutView",setup(gt){const M=z(),U=Q(),p=T(),r=A(),l=_(()=>p.activeProject),I=_(()=>r.activeRecords),N=_(()=>r.statusMap),i=M.params.id,{openModal:b,hasRole:v,closeModal:x}=F();p.loadDetail(i),r.loadRecordByID(i);const V=async(a,s)=>{await r.updateStatus(s,+a.target.value),r.loadRecordByID(i)},k={title:"",description:"",status:1},n=q({...k}),B=async()=>{console.log(n);const{data:a}=await r.createOrUpdateRecord({...n,project_id:+i});(a==null?void 0:a.errNo)==0?(Object.assign(n,{...k}),r.loadRecordByID(i),x("create")):alert(a.errMsg)},P=async a=>{U.push({name:"record",params:{id:a,pid:i}})},$=async()=>{var s,t;const a=await p.createOrUpdateProject({...l.value});((s=a.data)==null?void 0:s.errNo)===0?(p.loadDetail(i),x("update"),Object.assign(n,{})):alert((t=a.data)==null?void 0:t.errMsg)};return(a,s)=>(c(),u(y,null,[e("h3",{class:"mt-10 text-3xl cursor-pointer divide-light-600 px-3 md:px-4",onClick:s[0]||(s[0]=t=>o(b)("update"))},g(o(l).title),1),e("p",{class:"mt-4 px-3 md:px-4 cursor-pointer",onClick:s[1]||(s[1]=t=>o(b)("update"))},g(o(l).description),1),e("ul",G,[(c(!0),u(y,null,w(o(I),t=>(c(),u("li",H,[e("div",{class:"flex justify-between",onClick:f(d=>P(t.ID),["self"])},[e("div",{class:R(["underline",{"text-notion-yellow":t.status==1,"text-notion-teal":t.status==2,"":t.status==3,"text-notion-red line-through":t.status==4,"text-notion-gray line-through":t.status==5}])},g(t.title),3),e("select",{class:R(["px-10",{"bg-notion-yellow_background":t.status==1,"bg-notion-teal_background":t.status==2,"":t.status==3,"bg-notion-red_background":t.status==4,"bg-notion-gray_background":t.status==5}]),value:t.status,onChange:d=>V(d,t.ID)},[(c(!0),u(y,null,w(o(N),d=>(c(),u("option",{value:d.val},g(d.label),9,W))),256))],42,K)],8,J)]))),256))]),e("div",{class:"decoration-gray-400 px-4 text-center border-1 border-dark-500 border-dashed cursor-pointer hover:bg-stone-100 mx-20 mt-5 text-center w-2/4 xl:w-1/3",onClick:s[2]||(s[2]=t=>o(b)("create"))}," + "),X,o(v)("create")?(c(),D(S,{key:0,type:"create"},{default:j(()=>[e("form",{onSubmit:f(B,["prevent"]),class:"bg-white w-3/4 xl:w-2/3 m-auto px-8 py-5 mt-3 opacity-100"},[e("div",Z,[tt,m(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>n.title=t),required:"",minlength:"3",maxlength:"50",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Record Title"},null,512),[[h,n.title]])]),e("div",et,[st,e("div",ot,[E(o(L),{placeholder:"Record Description","content-type":"html",content:n.description,"onUpdate:content":s[4]||(s[4]=t=>n.description=t)},null,8,["content"])])]),at],40,Y)]),_:1})):C("",!0),o(v)("update")?(c(),D(S,{key:1,type:"update"},{default:j(()=>[e("form",{onSubmit:f($,["prevent"]),class:"bg-white w-3/4 xl:w-1/3 m-auto px-8 py-5 mt-3 opacity-100"},[e("div",nt,[rt,m(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>o(l).ID=t),type:"text",readonly:"",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500",placeholder:"Project Name"},null,512),[[h,o(l).ID]])]),e("div",it,[ct,m(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>o(l).title=t),type:"text",required:"",minlength:"3",maxlength:"50",class:"col-span-3 p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Project Name"},null,512),[[h,o(l).title]])]),e("div",dt,[ut,m(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=t=>o(l).description=t),maxlength:"120",class:"col-span-3 resize-none p-3 focus:border-dark-500 focus:ring-gray-500 placeholder-gray-500",placeholder:"Project Description"},null,512),[[h,o(l).description]])]),pt],40,lt)]),_:1})):C("",!0)],64))}});export{bt as default};
